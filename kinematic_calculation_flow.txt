運動学的計算の流れ図

┌─────────────────────────────────────────────────────────────────┐
│                    運動学的足先接地判定の流れ                      │
└─────────────────────────────────────────────────────────────────┘

1. 関節角度の取得
   ┌─────────────────┐
   │ 肩関節: 30度     │
   │ 膝関節: -45度   │
   └─────────────────┘
           │
           ▼

2. 左右対称の考慮
   ┌─────────────────┐
   │ 左側: そのまま   │
   │ 右側: 符号反転   │
   └─────────────────┘
           │
           ▼

3. 三角関数による位置計算
   ┌─────────────────────────────────────┐
   │ knee_y = 0.492 * cos(30°) = 0.426m  │
   │ knee_z = 0.492 * sin(30°) = 0.246m  │
   └─────────────────────────────────────┘
           │
           ▼

4. ローカル座標での足先位置
   ┌─────────────────────────────────────┐
   │ x = -0.446m (基準位置)              │
   │ y = 0.523 + 0.426 = 0.949m         │
   │ z = -0.021 + 0.246 = 0.225m        │
   └─────────────────────────────────────┘
           │
           ▼

5. ワールド座標への変換
   ┌─────────────────────────────────────┐
   │ ロボットの姿勢を考慮して回転・平行移動 │
   │ 最終位置: [-0.446, 0.949, 0.345]   │
   └─────────────────────────────────────┘
           │
           ▼

6. 地面との距離計算
   ┌─────────────────────────────────────┐
   │ 地面は z=0 にあると仮定              │
   │ 距離 = 0.345m (34.5cm)             │
   └─────────────────────────────────────┘
           │
           ▼

7. 接地判定
   ┌─────────────────────────────────────┐
   │ 閾値: 5cm以内                       │
   │ 0.345m > 0.05m → 接地していない      │
   └─────────────────────────────────────┘
           │
           ▼

8. 報酬計算
   ┌─────────────────────────────────────┐
   │ 足先接地報酬: 1.5                   │
   │ 適切な歩容報酬: 2.0                 │
   │ 高さ維持報酬: 3.0                   │
   │ 合計: 6.5                          │
   └─────────────────────────────────────┘

具体例: Bittleの左前足
- 肩関節角度: 30度
- 膝関節角度: -45度
- 計算結果: 地面から34.5cm離れている
- 判定: 接地していない
- 報酬: 高さ維持報酬のみ（3.0）
