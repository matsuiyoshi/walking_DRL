# Bittle + RTX 3050最適化設定
environment:
  name: "BittleWalking-v0"
  max_episode_steps: 2000  # エピソード長を延長（学習時間制限なし）
  control_frequency: 50
  physics_frequency: 240
  gravity: -9.81
  render_mode: None
  
robot:
  urdf_path: "bittle.urdf"
  initial_position: [0.0, 0.0, 0.12]  # Bittleの実際の高さに調整
  initial_orientation: [0.0, 0.0, 0.0]
  joint_limits: [-1.047, 1.047]  # ±60度（Bittleの実際の制限）
  max_torque: 0.2  # Bittleの実際のトルク（0.2Nm）
  
rewards:
  # VecNormalizeが正規化するため、生の値で設定
  forward_velocity_weight: 7.0       # 生の速度値（m/s）に適用
  survival_reward: 1.0               # 固定値
  fall_penalty: -50.0                # 転倒時のペナルティ
  energy_efficiency_weight: -0.01    # 生の角度変化量（rad）に適用
  orientation_stability_weight: 0.5  # 生の角度誤差（rad）に適用
  
  # 足先接地報酬計算方法の選択
  use_kinematic_contact: true        # true: 運動学的計算, false: 物理エンジンの接触検知
  
  # 足先接地報酬（大幅強化版：膝・肩這い防止）
  foot_contact_reward: 15.0          # 足先接地時の速度ボーナス係数（5.0→15.0: 3倍増）
  proper_gait_reward: 8.0            # 適切な歩容報酬（2-3本足接地）（4.0→8.0: 2倍増）
  body_clearance_reward: 30.0        # 胴体が地面から離れている報酬（15.0→30.0: 2倍増）
  target_height: 0.12                # 目標胴体高さ（12cm）
  height_reward_weight: 10.0         # 高さ維持報酬の重み（5.0→10.0: 2倍増）
  
  # 不適切な接地への強力なペナルティ（膝・肩這い防止）
  knee_contact_penalty: -200.0       # 膝が地面に接触した場合の大きなペナルティ（-30.0→-200.0: 6.7倍増）
  shoulder_contact_penalty: -500.0   # 【新規追加】肩が地面に接触した場合の非常に大きなペナルティ
  
  # 接地判定閾値
  contact_threshold: 0.03            # 接地判定の閾値（3cm）
  
  # 削除された報酬要素（VecNormalizeと競合するため）
  # height_stability_weight: 12.0
  # vertical_velocity_penalty: 5.0
  
termination:
  max_roll: 80.0     # 緩い設定
  max_pitch: 80.0    # 緩い設定

training:
  algorithm: "PPO"
  total_timesteps: 10000000  # 1000万ステップ（学習時間制限なし）
  n_envs: 12                  # 並列環境数を増加（RTX 3050対応）
  n_steps: 512              # ステップ数を最適化（メモリ効率化）
  learning_rate: 0.0001     # 学習率を安定化（並列環境数12対応）
  batch_size: 64            # バッチサイズを最適化（n_envs×5.3）
  n_epochs: 4               # エポック数を調整（過学習防止）
  gamma: 0.995              # 割引率を上げる（長期報酬重視）
  gae_lambda: 0.98          # GAEラムダを上げる
  clip_range: 0.2           # クリップ範囲
  ent_coef: 0.01            # エントロピー係数
  vf_coef: 0.5              # 価値関数係数
  max_grad_norm: 0.5        # 勾配クリッピング
  
save:
  frequency: 200000        # 20万ステップごとに保存（長時間学習対応）
  model_path: "./models"
  checkpoint_path: "./models/checkpoints"
  vec_normalize_path: "./models/vec_normalize.pkl"
  
evaluation:
  frequency: 100000        # 10万ステップごとに評価
  n_eval_episodes: 5       # 評価エピソード数を増加
  deterministic: true
  
logging:
  log_dir: "./logs"
  tensorboard: true
  verbose: 1
  debug_level: "INFO"      # デバッグレベルを調整